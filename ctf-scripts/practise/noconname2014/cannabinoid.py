__author__ = 'HuyNA'

import hexdump
import hashlib

def read_hex(data):
    return hexdump.dehex(data)

# 0x80 byte raw trong file khi chua dc load len mem
data1 = '''
7F 45 4C 46 01 01 01 00 00 00 00 00 00 00 00 00
02 00 03 00 01 00 00 00 00 DC 06 08 34 00 00 00
F4 00 00 00 00 00 00 00 34 00 20 00 06 00 28 00
0D 00 06 00 06 00 00 00 34 00 00 00 34 80 04 08
34 80 04 08 C0 00 00 00 C0 00 00 00 04 00 00 00
00 10 00 00 01 00 00 00 00 00 00 00 00 80 04 08
00 80 04 08 90 93 07 00 90 93 07 00 05 00 00 00
00 10 00 00 01 00 00 00 00 A0 07 00 00 20 0C 08
'''
# 0x80 bytes sau khi da duoc load len = mmap
data2 = '''
7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00
02 00 03 00 01 00 00 00 b0 83 04 08 34 00 00 00
e8 09 00 00 00 00 00 00 34 00 20 00 08 00 28 00
1c 00 1b 00 06 00 00 00 34 00 00 00 34 80 04 08
34 80 04 08 00 01 00 00 00 01 00 00 05 00 00 00
04 00 00 00 03 00 00 00 34 01 00 00 34 81 04 08
34 81 04 08 13 00 00 00 13 00 00 00 04 00 00 00
01 00 00 00 01 00 00 00 00 00 00 00 00 80 04 08
'''
a = read_hex(data2)
print len(a)
print a.encode('hex')
hashlib.sha1().update(a)
print hashlib.sha1(a).hexdigest()

# NcN_  da39a3ee5e6b4b0d3255bfef95601890afd80709  +> ko dc
#       da39a3ee5e6b4b0d3255bfef95601890afd80709